<div class="banner">
  <div class="banner-left">
    <h1>Portfolio Pro</h1>
  </div>
  <div class="banner-right">
    ðŸ‘¤ {{ user().name }}, {{ user().id }}
  </div>
</div>

<div class="account-bar">
  <label for="account">Account</label>
  <select id="account"
          [ngModel]="selectedAccountId()"
          (ngModelChange)="onAccountChanged($event)">
    <option *ngFor="let a of accounts()" [value]="a.id">
      {{ a.name }} (ID: {{ a.id }})
    </option>
  </select>
</div>

<div class="container">

    <section class="card">
      <h2>Add Trade</h2>
      <form (ngSubmit)="addTrade()" #f="ngForm">
        <div class="row">
          <label>Symbol</label>
          <input [(ngModel)]="newTrade.symbol" name="symbol" required maxlength="10" />
        </div>
        <div class="row">
          <label>Quantity</label>
          <input type="number" [(ngModel)]="newTrade.quantity" name="quantity" required />
        </div>
        <div class="row">
          <label>Open Date</label>
          <input type="date" [(ngModel)]="newTrade.openDate" name="openDate" required />
        </div>
        <div class="row">
          <label>Open Price</label>
          <input type="number" step="0.01" [(ngModel)]="newTrade.openPrice" name="openPrice" required />
        </div>
        <button type="submit">Add</button>
      </form>
    </section>
  
    <section class="card">
      <h2>Positions</h2>
      <table>
        <thead>
          <tr>
            <th>Symbol</th>
            <th>Qty</th>
            <th>Avg Cost</th>
            <th>Price</th>
            <th>Value</th>
            <th>Unrealized P/L</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let p of positions()">
            <td>{{ p.symbol }}</td>
            <td>{{ p.quantity }}</td>
            <td>{{ p.avgCost | number:'1.2-2' }}</td>
            <td>{{ p.marketPrice ?? '-' }}</td>
            <td>{{ p.marketValue ?? '-' }}</td>
            <td [class.positive]="p.unrealizedPnL >= 0" [class.negative]="p.unrealizedPnL < 0">
              {{ p.unrealizedPnL | number:'1.2-2' }}
            </td>
          </tr>
        </tbody>
      </table>
    </section>
  
    <section class="card">
      <h2>Trades</h2>
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Symbol</th>
            <th>Qty</th>
            <th>Date</th>
            <th>Price</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let t of trades()">
            <td>{{ t.id }}</td>
            <td>{{ t.symbol }}</td>
            <td>{{ t.quantity }}</td>
            <td>{{ t.openDate }}</td>
            <td>{{ t.openPrice | number:'1.2-2' }}</td>
            <td>
              <button type="button" (click)="removeTrade(t.id)">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </section>
  </div>
